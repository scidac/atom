#!/bin/bash
if [ ! -e $PREFIX/bin/conda ]
then
  echo 'conda command not found: This script will attempt to help you install it'
  if [ `uname` == "Darwin" ]
  then
    echo 'Mac OSX detected'
    CONDA_URL="https://repo.continuum.io/miniconda/Miniconda2-latest-MacOSX-x86_64.sh"
  elif [ `uname` == "Linux" ]
  then
    echo 'Linux detected'
    if [ `uname -p` == "x86_64" ]
    then
      echo '64 bit detected'
      CONDA_URL="https://repo.continuum.io/miniconda/Miniconda2-latest-Linux-x86_64.sh"
    else
      echo '32 bit detected'
      CONDA_URL="https://repo.continuum.io/miniconda/Miniconda2-latest-Linux-x86.sh"
    fi
  else
    echo 'OS not supported'
    exit
  fi
  echo "Installing conda from $CONDA_URL"
  CONDA_FN=/tmp/$USER/Miniconda-install.sh
  curl $CONDA_URL -o "$CONDA_FN"
  bash $CONDA_FN -p $PREFIX -b || exit
  YES='-y'
  conda config --system --add channels conda-forge --add channels smithsp
else
  PREFIX=$(dirname $(which conda))/..
  YES=''
fi
