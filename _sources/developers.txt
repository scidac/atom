Developers corner
=================

The AToM project is...


~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
Supported public AToM installations
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

We are supporting an AToM public installation on the EDISON supercomputer at NERSC.

Users must be part of the **atom*unix user group to access the NERSC public installation.

If you do not have an account at NERSC already, fill out `this form <https://nim.nersc.gov/nersc_account_request.php>`_ to request one. Use `AToM` for the repository name.

The project install directory in under `/project/projectdirs/atom/atom-install-edison`

~~~~~~~~~~~~~~~~~
Build AToM source
~~~~~~~~~~~~~~~~~

Contact :ref:`contact <Jeff Candy>` to obtain access to the `AToM GitHub repository <https://github.com/scidac/atom>`_ (GitHub account needed)

To clone the repository::

    git clone git@github.com:scidac/atom.git

This will make a `atom` directory with a `Makefile` in it::

    cd atom
    ls

The `Makefile` is capable of downloading the source of the individual AToM components and building them.
The AToM `Makefile` leverages the `GACODE <https://github.com/gafusion/gacode>`_ build system, and as such it supports compilation of its components on several platforms:

===================             ===================
C1                              C2
===================             ===================
ALCF_BGP                        HPC_ITE
ALCF_CETUS                      IFORT_CORE2
BABBAGE                         IFORT_PENRYN
BANACH                          JAC
CAOS                            LINDGREN
CARVER                          LOHAN
CMODWS                          LOKI
DELPHI                          LOKI_SCRATCH
DROP                            METIUS
EDISON_CRAY                     NEWT
EDISON_INTEL                    OSX_MOUNTAINLION
FT                              PACER
GFORTRAN_CORE2                  PGFORTRAN_OSX
GFORTRAN_OSX                    PG_OPT6
GFORTRAN_OSX_64                 PG_OPT64_FFTW
GFORTRAN_OSX_BELLI              PG_OPT64_MUMPS
GFORTRAN_OSX_MACPORTS           PPPL
GFORTRAN_OSX_TECHX              PPPL_PATHSCALE
GFORTRAN_PENRYN                 RANGER
GFORTRAN_TECHX                  SATURN
HOPPER_CRAY                     TITAN_CRAY
HOPPER_INTEL                    VENUS
===================             ===================

AToM components include::

    OMFIT IPS_ATOM GACODE HARVEST_CLIENT GACODE_ADD EPED

To make individual components (for example `GACODE` on the `VENUS` platform)::

    make GACODE PLATFORM=VENUS

To make all of the AToM components::

    make all PLATFORM=VENUS

The `Makefile` takes care of satisfying any interdependency between the AToM components.

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
Maintaining an AToM installation up-to-date
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

The AToM `Makefile` is also capable to keep the components up-to-date and in sync with each others-versions.
To update the AToM installation::

    cd atom
    git pull
    make all PLATFORM=VENUS

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
To update and build this documentation
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

The AToM documentation (`published online at this website <http://scidac.github.io/atom/>`_)
is self contained in the AToM repository.

The python packages required for buidling the AToM documentation can be installed with::

    sudo yum install sphinx
    sudo yum install python-sphinx
    sudo pip install sphinx-bootstrap-theme
    sudo pip install sphinxcontrib.bibtex

To build a local copy of the website::

    cd atom
    make website

which will generate the HTML pages in the directory::

    cd atom-website/html

To see the website locally point your browser to open the `index.html` contained in that directory. For example ::

    firefox file:///...../atom-website/html/index.html

To publish the documentation online (must have write permissions to the `AToM GitHub repository <https://github.com/scidac/atom>`_)::

    cd atom
    make online
